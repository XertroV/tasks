---
id: P22.M2.E1.T002
title: Implement fetch_models/1 for Anthropic provider (GET /v1/models)
status: done
estimate_hours: 1.0
complexity: low
priority: medium
depends_on:
- P22.M2.E1.T001
tags: []
claimed_by: cli-user
claimed_at: '2026-02-18T14:41:43.785883+00:00'
started_at: '2026-02-18T14:41:43.785883+00:00'
completed_at: '2026-02-18T14:50:02.786926+00:00'
duration_minutes: 8.316683866666667
---
Implement fetch_models/1 in lib/pag_server/llm/providers/anthropic.ex. Hit GET https://api.anthropic.com/v1/models with the provider's api_key. Map response to model_info() structs. Handle auth errors gracefully (return {:error, :auth_failed}). Acceptance criteria: - Returns {:ok, list} on success - Returns {:error, reason} on HTTP failure - Parses id, display_name (as name), context_window (as context_length) from response - supports_tools: true for all Anthropic models by default

## Sibling Batch Instructions

**Batch mode**: siblings (same epic: P22.M2.E1)
**Agent**: cli-user
**Date**: 2026-02-18 14:41 UTC
**Sibling tasks**: P22.M2.E1.T003

**Instructions**:
This task is part of a sibling batch from the same epic.
Spawn ONE subagent to implement ALL sibling tasks sequentially.
Work through tasks in order: P22.M2.E1.T002 â†’ P22.M2.E1.T003
Mark each done individually after completion.

**Task files**:
- P22.M2.E1.T002: .tasks/22-llm-provider-session-enhanceme/02-live-model-discovery/01-provider-behaviour-fetch-model/T002-implement-fetch-models-1-for-a.todo
- P22.M2.E1.T003: .tasks/22-llm-provider-session-enhanceme/02-live-model-discovery/01-provider-behaviour-fetch-model/T003-implement-fetch-models-1-for-o.todo
