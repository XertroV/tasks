---
id: I054
title: Create a credentials manager plugin so the agent can store credentials securely.
  Rate limited to prevent exfil. Should have basic functionality of a password mgr
  like 1password.
status: done
estimate_hours: 10.0
complexity: medium
priority: medium
depends_on: []
tags:
- idea
- planning
---

# Idea Intake: Create a credentials manager plugin so the agent can store credentials securely. Rate limited to prevent exfil. Should have basic functionality of a password mgr like 1password.

## Original Idea

Create a credentials manager plugin so the agent can store credentials securely. Rate limited to prevent exfil. Should have basic functionality of a password mgr like 1password.

## Planning Task (Equivalent of /plan-task)

- Run `/plan-task "Create a credentials manager plugin so the agent can store credentials securely. Rate limited to prevent exfil. Should have basic functionality of a password mgr like 1password."` to decompose this idea into actionable work.
- Confirm placement in the current `.tasks` hierarchy before creating work items.

## Ingest Plan Into .tasks

- Create implementation items with `tasks add` and related hierarchy commands (`tasks add-epic`, `tasks add-milestone`, `tasks add-phase`) as needed.
- Create follow-up defects with `tasks bug` when bug-style work is identified.
- Record all created IDs below and wire dependencies.

## Created Work Items

- P45 — Credentials Vault Plugin (phase)
- P45.M1 — Plugin Scaffold & DB Schema
  - P45.M1.E1 — Plugin Directory & Manifest
    - P45.M1.E1.T001 — Create plugins/credentials_vault/ directory structure
    - P45.M1.E1.T002 — Implement top-level CredentialsVault plugin module
  - P45.M1.E2 — DB Migrations
    - P45.M1.E2.T001 — Migration V1: vault_secrets table
    - P45.M1.E2.T002 — Migration V2: vault_secret_versions table
    - P45.M1.E2.T003 — Migration V3: vault_access_grants & vault_access_log tables
- P45.M2 — Core Vault CRUD & History
  - P45.M2.E1 — Vault Context Module
    - P45.M2.E1.T001 — Define VaultSecret and VaultSecretVersion Ecto schemas
    - P45.M2.E1.T002 — Implement Vault.store/2 and Vault.fetch_current/2
    - P45.M2.E1.T003 — Implement Vault.list/1, delete/2, rotate/2, history/2
    - P45.M2.E1.T004 — Write unit tests for Vault context module
- P45.M3 — Agent MCP Tool Interface
  - P45.M3.E1 — MCP Tool Handler
    - P45.M3.E1.T001 — Implement handle_tool_call/3 dispatcher with action enum
    - P45.M3.E1.T002 — Implement store, fetch, list action handlers
    - P45.M3.E1.T003 — Implement delete, rotate, history, help action handlers
    - P45.M3.E1.T004 — Write tool call integration tests
- P45.M4 — Anti-Exfil Rate Limiting
  - P45.M4.E1 — Token Bucket Rate Limiter
    - P45.M4.E1.T001 — Implement per-agent token bucket in ETS
    - P45.M4.E1.T002 — Wire RateLimiter into plugin supervisor and tool fetch handler
    - P45.M4.E1.T003 — Write rate limiter tests
- P45.M5 — Scopes & Cross-Workspace Sharing
  - P45.M5.E1 — Scope Resolution & Access Grants
    - P45.M5.E1.T001 — Define VaultAccessGrant Ecto schema and changeset
    - P45.M5.E1.T002 — Implement Vault.share/3, revoke_share/2, and access resolution
    - P45.M5.E1.T003 — Add share/revoke_share MCP tool actions
    - P45.M5.E1.T004 — Write scope and sharing tests
- P45.M6 — Human REST API
  - P45.M6.E1 — REST Controllers & Routes
    - P45.M6.E1.T001 — Add REST router scope and controller skeleton
    - P45.M6.E1.T002 — Implement CRUD controller actions (no reveal)
    - P45.M6.E1.T003 — Implement reveal endpoint with rate limit and audit log
    - P45.M6.E1.T004 — Write controller tests
- P45.M7 — Audit, Observability & Housekeeping
  - P45.M7.E1 — Telemetry, Pruning & Tests
    - P45.M7.E1.T001 — Emit telemetry on all vault operations
    - P45.M7.E1.T002 — Implement Oban worker for TTL-based version pruning
    - P45.M7.E1.T003 — End-to-end smoke test and mix lint cleanup

## Completion Criteria

- Idea has been decomposed into concrete `.tasks` work items.
- New items include clear acceptance criteria and dependencies.
- This idea intake is updated with created IDs and marked done.
