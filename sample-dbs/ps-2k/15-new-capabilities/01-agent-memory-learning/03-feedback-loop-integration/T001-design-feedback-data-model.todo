---
id: P15.M1.E3.T001
title: Design feedback data model
status: done
estimate_hours: 1.0
complexity: medium
priority: medium
depends_on: []
tags: []
claimed_by: cli-user
claimed_at: '2026-02-13T12:37:24.236456+00:00'
started_at: '2026-02-13T12:37:24.236456+00:00'
completed_at: '2026-02-13T13:53:47.368426+00:00'
duration_minutes: 76.38553266666666
---

# Design feedback data model

## Description
Design a schema for collecting and storing user feedback on agent responses. Support both explicit feedback (thumbs up/down, ratings) and implicit feedback (edits, regenerations, follow-up corrections).

## Acceptance Criteria
- [ ] Create `PagServer.Schema.Feedback` with fields for session_id, message_id, feedback_type, rating, correction, metadata
- [ ] Define feedback types: thumbs_up, thumbs_down, rating (1-5), correction, edit, regeneration
- [ ] Add optional correction field for users to provide correct response
- [ ] Include context snapshot (what led to this response)
- [ ] Add timestamp and user identification
- [ ] Database migration created and tested
- [ ] Tests pass
- [ ] Lint passes

## Context
- Related files: `lib/pag_server/schema/session.ex`, `lib/pag_server/schema/message.ex`, `lib/pag_server/schema/event.ex`
- Part of epic: Feedback Loop Integration
- Reference Event schema for immutable record patterns


## Sibling Batch Instructions

**Batch mode**: siblings (same epic: P15.M1.E3)
**Agent**: cli-user
**Date**: 2026-02-13 12:37 UTC
**Sibling tasks**: P15.M1.E3.T002, P15.M1.E3.T003

**Instructions**:
This task is part of a sibling batch from the same epic.
Spawn ONE subagent to implement ALL sibling tasks sequentially.
Work through tasks in order: P15.M1.E3.T001 → P15.M1.E3.T002 → P15.M1.E3.T003
Mark each done individually after completion.

**Task files**:
- P15.M1.E3.T001: .tasks/15-new-capabilities/01-agent-memory-learning/03-feedback-loop-integration/T001-design-feedback-data-model.todo
- P15.M1.E3.T002: .tasks/15-new-capabilities/01-agent-memory-learning/03-feedback-loop-integration/T002-implement-thumbs-up-down-colle.todo
- P15.M1.E3.T003: .tasks/15-new-capabilities/01-agent-memory-learning/03-feedback-loop-integration/T003-add-correction-storage-for-fut.todo
