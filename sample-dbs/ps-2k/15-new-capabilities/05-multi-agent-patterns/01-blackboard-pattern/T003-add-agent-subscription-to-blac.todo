---
id: P15.M5.E1.T003
title: Add agent subscription to blackboard
status: done
estimate_hours: 1.0
complexity: medium
priority: medium
depends_on:
- P15.M5.E1.T002
tags: []
claimed_by: cli-user
claimed_at: '2026-02-13T16:34:43.340952+00:00'
started_at: '2026-02-13T16:34:43.340952+00:00'
completed_at: '2026-02-13T16:56:24.881845+00:00'
duration_minutes: 21.692348033333335
---

# Add agent subscription to blackboard

## Description
Enable agents to subscribe to blackboard changes. Agents receive notifications when entries matching their subscription criteria are added, modified, or deleted.

## Acceptance Criteria
- [ ] Create `PagServer.Blackboard.Subscription` module
- [ ] Implement `subscribe(agent_id, workspace_id, pattern)` function
- [ ] Support subscription patterns: key prefix, entry type, owner
- [ ] Emit notifications via PubSub on entry changes
- [ ] Handle agent disconnect/cleanup for subscriptions
- [ ] Add subscription persistence for agent restart recovery
- [ ] Implement subscription rate limiting
- [ ] Tests pass
- [ ] Lint passes

## Context
- Related files: `lib/pag_server/blackboard/server.ex`, `lib/pag_server/cluster/pub_sub.ex`, `lib/pag_server/agents/agent.ex`
- Part of epic: Blackboard Pattern
- Use existing PubSub infrastructure
